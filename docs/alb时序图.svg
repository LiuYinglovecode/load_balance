<svg id="SvgjsSvg1181" width="943" height="979" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1182"><marker id="SvgjsMarker1202" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1203" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1209" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1210" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1214" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1215" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1223" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1224" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1228" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1229" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1233" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1234" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1238" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1239" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1243" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1244" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1252" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1253" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1257" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1258" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1262" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1263" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1269" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1270" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker></defs><g id="SvgjsG1183" transform="translate(25,25)"><path id="SvgjsPath1184" d="M 59.5 30L 59.5 929" stroke-dasharray="3,4" stroke="#323232" stroke-width="2" fill="none"></path><path id="SvgjsPath1185" d="M 0 0L 119 0L 119 30L 0 30Z" stroke="#323232" stroke-width="2" fill="#ffffff"></path><g id="SvgjsG1186"><foreignObject id="SvgjsForeignObject1187" width="99" height="16" x="10" style="overflow:visible;" y="7"><div xmlns="http://www.w3.org/1999/xhtml" style="font-family: 微软雅黑; text-align: center; font-size: 13px; vertical-align: middle; color: rgb(50, 50, 50); font-weight: 400; line-height: 16px; width: 99px; word-break: break-word; border: 0px;">client</div></foreignObject></g></g><g id="SvgjsG1188" transform="translate(364,26)"><path id="SvgjsPath1189" d="M 61 30L 61 927" stroke-dasharray="3,4" stroke="#323232" stroke-width="2" fill="none"></path><path id="SvgjsPath1190" d="M 0 0L 122 0L 122 30L 0 30Z" stroke="#323232" stroke-width="2" fill="#ffffff"></path><g id="SvgjsG1191"><foreignObject id="SvgjsForeignObject1192" width="102" height="16" x="10" style="overflow:visible;" y="7"><div xmlns="http://www.w3.org/1999/xhtml" style="font-family: 微软雅黑; text-align: center; font-size: 13px; vertical-align: middle; color: rgb(50, 50, 50); font-weight: 400; line-height: 16px; width: 102px; word-break: break-word; border: 0px;">LBMC</div></foreignObject></g></g><g id="SvgjsG1193" transform="translate(815,26)"><path id="SvgjsPath1194" d="M 51.5 30L 51.5 927" stroke-dasharray="3,4" stroke="#323232" stroke-width="2" fill="none"></path><path id="SvgjsPath1195" d="M 0 0L 103 0L 103 30L 0 30Z" stroke="#323232" stroke-width="2" fill="#ffffff"></path><g id="SvgjsG1196"><foreignObject id="SvgjsForeignObject1197" width="83" height="16" x="10" style="overflow:visible;" y="7"><div xmlns="http://www.w3.org/1999/xhtml" style="font-family: 微软雅黑; text-align: center; font-size: 13px; vertical-align: middle; color: rgb(50, 50, 50); font-weight: 400; line-height: 16px; width: 83px; word-break: break-word; border: 0px;">lBAgent</div></foreignObject></g></g><g id="SvgjsG1198" transform="translate(410,89.56465846832974)"><path id="SvgjsPath1199" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 110.31185031185032Q 30 114.31185031185032 26 114.31185031185032L 4 114.31185031185032Q 0 114.31185031185032 0 110.31185031185032L 0 4Z" stroke="#323232" stroke-width="2" fill="#ffffff"></path></g><g id="SvgjsG1200"><path id="SvgjsPath1201" d="M410.50629863176323 195.15999711254975L254.5531447382449 195.15999711254975L254.5531447382449 195.4000015258789L98.59999084472656 195.4000015258789" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1202)"></path><foreignObject id="SvgjsForeignObject1204" width="92" height="16" x="208.5531447382449" y="187.27999931921434"><div xmlns="http://www.w3.org/1999/xhtml" style="vertical-align: top; text-align: center; color: rgb(50, 50, 50); line-height: 16px; font-size: 13px; font-family: 微软雅黑; white-space: nowrap; display: inline-block; background: rgb(255, 255, 255);">返回 request id</div></foreignObject></g><g id="SvgjsG1205" transform="translate(69.5,87.4000015258789)"><path id="SvgjsPath1206" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 112Q 30 116 26 116L 4 116Q 0 116 0 112L 0 4Z" stroke="#323232" stroke-width="2" fill="#ffffff"></path></g><g id="SvgjsG1207"><path id="SvgjsPath1208" d="M98.73396544094211 94.4000015258789L254.51620969479916 94.4000015258789L254.51620969479916 96.87687360214196L410.2984539486561 96.87687360214196" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1209)"></path><foreignObject id="SvgjsForeignObject1211" width="249" height="16" x="130.01620969479916" y="87.63843756401039"><div xmlns="http://www.w3.org/1999/xhtml" style="vertical-align: top; text-align: center; color: rgb(50, 50, 50); line-height: 16px; font-size: 13px; font-family: 微软雅黑; white-space: nowrap; display: inline-block; background: rgb(255, 255, 255);">发起 request 申请/更新/删除load balance</div></foreignObject></g><g id="SvgjsG1212"><path id="SvgjsPath1213" d="M439.59999084472656 100.995841995842L469.59999084472656 100.995841995842L469.59999084472656 187.7151767151767L439.59999084472656 187.7151767151767" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1214)"></path><foreignObject id="SvgjsForeignObject1216" width="72" height="45" x="433.59999084472656" y="121.85550935550935"><div xmlns="http://www.w3.org/1999/xhtml" style="vertical-align: top; text-align: center; color: rgb(50, 50, 50); line-height: 15px; font-size: 12px; font-family: 微软雅黑; white-space: nowrap; display: inline-block; background: rgb(255, 255, 255);">Client请求<div></div>写入数据库<div></div>写入消息队列</div></foreignObject></g><g id="SvgjsG1217" transform="translate(410,238.3671532708246)"><path id="SvgjsPath1218" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 391.6328467291754Q 30 395.6328467291754 26 395.6328467291754L 4 395.6328467291754Q 0 395.6328467291754 0 391.6328467291754L 0 4Z" stroke="#323232" stroke-width="2" fill="#ffffff"></path></g><g id="SvgjsG1219" transform="translate(851.5,384.92598602231476)"><path id="SvgjsPath1220" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 60.07401397768524Q 30 64.07401397768524 26 64.07401397768524L 4 64.07401397768524Q 0 64.07401397768524 0 60.07401397768524L 0 4Z" stroke="#323232" stroke-width="2" fill="#ffffff"></path></g><g id="SvgjsG1221"><path id="SvgjsPath1222" d="M440 388L646.180735814375 388L646.180735814375 386.8557224926145L852.36147162875 386.8557224926145" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1223)"></path><foreignObject id="SvgjsForeignObject1225" width="246" height="32" x="523.180735814375" y="371.42786124630726"><div xmlns="http://www.w3.org/1999/xhtml" style="vertical-align: top; text-align: center; color: rgb(50, 50, 50); line-height: 16px; font-size: 13px; font-family: 微软雅黑; white-space: nowrap; display: inline-block; background: rgb(255, 255, 255);">根据消息类型建立与LBAgent的TCP长连接<div></div>（grpc/sellnet/...)</div></foreignObject></g><g id="SvgjsG1226"><path id="SvgjsPath1227" d="M440 264.61617298354304L470 264.61617298354304L470 348L440 348" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1228)"></path><foreignObject id="SvgjsForeignObject1230" width="294" height="32" x="323" y="290.3080864917715"><div xmlns="http://www.w3.org/1999/xhtml" style="vertical-align: top; text-align: center; color: rgb(50, 50, 50); line-height: 16px; font-size: 13px; font-family: 微软雅黑; white-space: nowrap; display: inline-block; background: rgb(255, 255, 255);">LBMC监听听请求消息队列,如果获取到request消息<div></div>将数据库中请求状态修改为处理中</div></foreignObject></g><g id="SvgjsG1231"><path id="SvgjsPath1232" d="M851.9961946980917 444.20267780516895L645.9980973490458 444.20267780516895L645.9980973490458 444.20267780516895L440 444.20267780516895" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1233)"></path><foreignObject id="SvgjsForeignObject1235" width="116" height="16" x="587.9980973490459" y="436.20267780516895"><div xmlns="http://www.w3.org/1999/xhtml" style="vertical-align: top; text-align: center; color: rgb(50, 50, 50); line-height: 16px; font-size: 13px; font-family: 微软雅黑; white-space: nowrap; display: inline-block; background: rgb(255, 255, 255);">Agent返回处理结果</div></foreignObject></g><g id="SvgjsG1236"><path id="SvgjsPath1237" d="M440 472L470 472L470 587L440 587" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1238)"></path><foreignObject id="SvgjsForeignObject1240" width="191" height="32" x="374.5" y="513.5"><div xmlns="http://www.w3.org/1999/xhtml" style="vertical-align: top; text-align: center; color: rgb(50, 50, 50); line-height: 16px; font-size: 13px; font-family: 微软雅黑; white-space: nowrap; display: inline-block; background: rgb(255, 255, 255);">LBMC根据返回结Agent返回结果<div></div>更新数据库中的请求状态</div></foreignObject></g><g id="SvgjsG1241"><path id="SvgjsPath1242" d="M881.0114159057248 391.26146722824296L911.0114159057248 391.26146722824296L911 440L881 440" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1243)"></path><foreignObject id="SvgjsForeignObject1245" width="52" height="16" x="885.0057079528624" y="407.6307336141215"><div xmlns="http://www.w3.org/1999/xhtml" style="vertical-align: top; text-align: center; color: rgb(50, 50, 50); line-height: 16px; font-size: 13px; font-family: 微软雅黑; white-space: nowrap; display: inline-block; background: rgb(255, 255, 255);">开始处理</div></foreignObject></g><g id="SvgjsG1246" transform="translate(69.5,659)"><path id="SvgjsPath1247" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 96Q 30 100 26 100L 4 100Q 0 100 0 96L 0 4Z" stroke="#323232" stroke-width="2" fill="#ffffff"></path></g><g id="SvgjsG1248" transform="translate(416,665)"><path id="SvgjsPath1249" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 96Q 30 100 26 100L 4 100Q 0 100 0 96L 0 4Z" stroke="#323232" stroke-width="2" fill="#ffffff"></path></g><g id="SvgjsG1250"><path id="SvgjsPath1251" d="M99 675L257.5 675L257.5 675L416 675" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1252)"></path><foreignObject id="SvgjsForeignObject1254" width="235" height="16" x="140" y="667"><div xmlns="http://www.w3.org/1999/xhtml" style="vertical-align: top; text-align: center; color: rgb(50, 50, 50); line-height: 16px; font-size: 13px; font-family: 微软雅黑; white-space: nowrap; display: inline-block; background: rgb(255, 255, 255);">客户端携带request id 查询请求处理结果</div></foreignObject></g><g id="SvgjsG1255"><path id="SvgjsPath1256" d="M446 680L476 680L476 742L446 742" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1257)"></path><foreignObject id="SvgjsForeignObject1259" width="169" height="32" x="391.5" y="695"><div xmlns="http://www.w3.org/1999/xhtml" style="vertical-align: top; text-align: center; color: rgb(50, 50, 50); line-height: 16px; font-size: 13px; font-family: 微软雅黑; white-space: nowrap; display: inline-block; background: rgb(255, 255, 255);">查询数据库，返回结果<div></div>可能是处理中，成功或者失败</div></foreignObject></g><g id="SvgjsG1260"><path id="SvgjsPath1261" d="M416 749L257.75 749L257.75 749L99.5 749" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1262)"></path><foreignObject id="SvgjsForeignObject1264" width="114" height="16" x="200.75" y="741"><div xmlns="http://www.w3.org/1999/xhtml" style="vertical-align: top; text-align: center; color: rgb(50, 50, 50); line-height: 16px; font-size: 13px; font-family: 微软雅黑; white-space: nowrap; display: inline-block; background: rgb(255, 255, 255);">LBMC返回出里结果</div></foreignObject></g><g id="SvgjsG1265" transform="translate(851.5,146)"><path id="SvgjsPath1266" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 96Q 30 100 26 100L 4 100Q 0 100 0 96L 0 4Z" stroke="#323232" stroke-width="2" fill="#ffffff"></path></g><g id="SvgjsG1267"><path id="SvgjsPath1268" d="M881 156L911 156L911 233L881 233" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1269)"></path><foreignObject id="SvgjsForeignObject1271" width="79" height="32" x="871.5" y="178.5"><div xmlns="http://www.w3.org/1999/xhtml" style="vertical-align: top; text-align: center; color: rgb(50, 50, 50); line-height: 16px; font-size: 13px; font-family: 微软雅黑; white-space: nowrap; display: inline-block; background: rgb(255, 255, 255);">定时向etcd中<div></div>写入自身状态</div></foreignObject></g></svg>