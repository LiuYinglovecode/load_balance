# 1. 部署etcd:
在172.17.60.113上以docker方式部署etcd服务, etcd数据存储在/tmp/etcd-data.tmp文件中
在开发人员自己的机器上也可以建立etcd, 可以选择二进制部署或者docker部署

部署命令如下, 如果需要保留原始数据，不要删除etcd-data.tmp
```
rm -rf /tmp/etcd-data.tmp && mkdir -p /tmp/etcd-data.tmp && \
  docker rmi quay.io/coreos/etcd:v3.3.12 || true && \
  docker run -d \
  -p 2379:2379 \
  -p 2380:2380 \
  --mount type=bind,source=/tmp/etcd-data.tmp,destination=/etcd-data \
  --name adc-etcd-v3.3.12 \
  quay.io/coreos/etcd:v3.3.12 \
  /usr/local/bin/etcd \
  --name s1 \
  --data-dir /etcd-data \
  --listen-client-urls http://0.0.0.0:2379 \
  --advertise-client-urls http://0.0.0.0:2379 \
  --listen-peer-urls http://0.0.0.0:2380 \
  --initial-advertise-peer-urls http://0.0.0.0:2380 \
  --initial-cluster s1=http://0.0.0.0:2380 \
  --initial-cluster-token tkn \
  --initial-cluster-state new
```
如果在本地windows启动，执行如下命令, 其中source指定的文件夹必须存在
```
docker run -d -p 2379:2379 -p 2380:2380 --mount type=bind,source=c:\Users\tiany\etcd-data,destination=/etcd-data --name adc-etcd-v3.3.12 quay.io/coreos/etcd:v3.3.12 /usr/local/bin/etcd --name s1 --data-dir /etcd-data --listen-client-urls http://0.0.0.0:2379 --advertise-client-urls http://0.0.0.0:2379 --listen-peer-urls http://0.0.0.0:2380 --initial-advertise-peer-urls http://0.0.0.0:2380 --initial-cluster s1=http://0.0.0.0:2380 --initial-cluster-token tkn --initial-cluster-state new
```
# 2. etcd 开启https
在生产环境中需要开启etcd客户端以及服务器端双向认证。SSL/TSL 认证分单向认证和双向认证两种方式。简单说就是单向认证只是客户端对服务端的身份进行验证，双向认证是客户端和服务端互相进行身份认证。就比如，我们登录淘宝买东西，为了防止我们登录的是假淘宝网站，此时我们通过浏览器打开淘宝买东西时，浏览器会验证我们登录的网站是否是真的淘宝的网站，而淘宝网站不关心我们是否“合法”，这就是单向认证。而双向认证是服务端也需要对客户端做出认证。


# 3. 本地开发环境 
## 3.1 agent模块
开发环境需要安装docker来调试agent模块, agent在本机启动HAProxy docker, 然后代理某一端口访问某web服务，访问正常说明代码正确.
## 3.2 client模块
运行lbmc模块后，通过单元测试，传入lbmc地址进行调试


# 参考
[Generate self-signed certificates 官方参考文档](https://coreos.com/os/docs/latest/generate-self-signed-certificates.html)